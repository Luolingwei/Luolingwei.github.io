---
title: 'Distributed Systems'
date: 2020-05-10
permalink: /posts/2020/05/blog-post-24/
tags:
  - Interview
---

This is my personal notes for Distributed Systems.


-----------------------------------

CAP理论
-----------------
分布式系统的CAP理论是由Eric Brewer于1999年首先提出的，CAP是对Consistency（一致性）、Availability（可用性）、Partition tolerance（分区容忍性）的一种简称，如下图所示：

* 一致性（C）：指强一致性，在分布式系统中的同一数据有多个副本的情形下，对于数据的更新操作体现出的效果与只有单份数据是一样的。要求数据被一致地更新，所有数据变动都是同步的。

* 可用性（A）：客户端在任何时刻对大规模数据系统的读/写操作都应该保证在限定延时内完成。即系统在面对各种异常时，依然可以响应客户端的读/写请求并提供正常服务。

* 分区容忍性（P）：以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况（分布式系统一定会发生分区的情况的，因为存在网络中断、消息丢失等网络问题）。分区容忍性即指在网络中断、消息丢失的情况下，系统照样能够工作。

Eric Brewer在提出CAP概念的同时，也证明了CAP定理：任何分布式系统在可用性、一致性、分区容忍性方面，不可能同时被满足，最多只能得其二。该定理也被称作布鲁尔定理（Brewer's theorem）。任何分布式系统的设计只是在C、A、P三者中的不同取舍而已，要么AP，要么CP，要么AC，但是不存在CAP同时存在的情况，这就是CAP定理的精髓所在。在网络环境下，运行环境出现网络分区/分割一般是不可避免的，所以分布式系统一般必须具备分区容忍性P。因此，在设计分布式系统时，架构师一般在C和A之间进行权衡和选择，即要么CP，要么AP。当然，如果系统要求为强事务型，比如面向网上支付等金融交易，我们也可以选择CA，支付宝的OceanBase就是如此。


-----------------------------------

BASE理论
-------------
对于很多互联网应用来说，对一致性的要求可以降低，而可用性的要求则更为重要，从而产生了弱一致性的BASE理论。BASE理论是基于CAP理论逐步演化而来的，其核心思想是即使不能达到强一致性，也可以根据应用特点采用适当的方法来达到最终一致性的效果。BASE是Basically Available（基本可用）、Soft state（软状态/柔性状态）、Eventually consistent（最终一致性）三个词组的简写，是对CAP中C和A的延伸。

BASE理论的含义如下：

基本可用：在绝大多数时间内系统处于可用状态，允许偶尔的失败。
软状态/柔性状态：数据状态不要求在任意时刻都完全保持同步，即状态可以有一段时间不同步。
最终一致性：与强一致性相比，最终一致性是一种弱一致性。尽管软状态不要求任意时刻数据保持一致同步，但是最终一致性要求在给定时间窗口内数据会达到一致状态。
以上就是BASE理论的基本概念，可见BASE理论强调的是系统的高可用，允许系统在一定时间内存在数据不一致，但在给定的时间窗口内，系统最终一定是要达到一致状态的。
